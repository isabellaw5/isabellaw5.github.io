<!DOCTYPE html>
<html>


<head>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-131424144-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-131424144-1');
</script>
<style>
/* Add a black background color to the top navigation */
/* Add a black background color to the top navigation */
.topnav {
  background-color: #333;
  overflow: hidden;
}

/* Style the links inside the navigation bar */
.topnav a {
  float: left;
  color: #f2f2f2;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
  font-size: 17px;
}

/* Change the color of links on hover */
.topnav a:hover {
  background-color: #333;
  color: #004aad;
}

/* Add a color to the active/current link */
.topnav a.active {
  background-color: #004aad;
  color: white;
}


body, html {
text-decoration: none;
    height: 100%;
	background-color: white;
	color: black;
	margin: auto;
	font-family: "Courier New", Courier, monospace;
	padding: 0px;
	margin-top: 0px; 
	
}

/* The hero image */
* {
margin: 0;
padding: 0;
}
.hero-image {
  /* Use "linear-gradient" to add a darken background effect to the image (photographer.jpg). This will make the text easier to read */
 
  /* Position and center the image to scale nicely on all screens */
  height: 75%;
  background-image: url("manualBanner.png");
  background-position: center;
  background-repeat: no-repeat;
  background-size: cover;
  position: relative;
}

/* Place text in the middle of the image */
.hero-text {
  text-align: center;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: white;
}

.header {
  padding:  0px;
  text-align: center;
  background: #A6D3F7;
  color: white;
  font-size: 30px;
  font: Open Sans;
}

.a{
	font: black;
}
div.container {
  padding: 5px;
}

img {
  opacity: 1.0;
}




.float-container {
    border: 3px;
    padding: 50px;
	font: black;


}

div.container3 {
	margin-left: 10%;
}

.float-child {
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
  text-align: center;
	width: 35%;
    float: left;
	margin-left: 7%;
    padding: 20px;
    border: 2px;
	margin-bottom: 25px;
	
}  

div.Bodycontainer {
  padding-left: 5%;
  padding-right: 5%;
  padding-bottom: 1%;
  padding-top: 1%;
  text-align: left;
  background-color: #4AB0F8; /* For browsers that do not support gradients */
  background-image: linear-gradient(white, #4AB0F8, white); /* Standard syntax (must be last) */

}



/* Button used to open the contact form - fixed at the bottom of the page */
.open-button {
  background-color: #555;
  color: white;
  padding: 15px 20px;
  border: none;
  cursor: pointer;
  opacity: 0.8;
  position: fixed;
  bottom: 23px;
  right: 28px;
  width: 250px;
  font-size: 15px;
}

/* The popup form - hidden by default */
.form-popup {
  display: none;
  position: fixed;
  bottom: 0;
  right: 15px;
  border: 3px solid #f1f1f1;
  z-index: 9;
}

/* Add styles to the form container */
.form-container {
  max-width: 300px;
  padding: 10px;
  background-color: white;
}

/* Full-width input fields */
.form-container input[type=text], .form-container input[type=password] {
  width: 100%;
  padding: 15px;
  margin: 5px 0 22px 0;
  border: none;
  background: #f1f1f1;
}

/* When the inputs get focus, do something */
.form-container input[type=text]:focus, .form-container input[type=password]:focus {
  background-color: #ddd;
  outline: none;
}

/* Set a style for the submit/login button */
.form-container .btn {
  background-color: #4CAF50;
  color: white;
  padding: 16px 20px;
  border: none;
  cursor: pointer;
  width: 100%;
  margin-bottom:10px;
  opacity: 0.8;
}

/* Add a blue background color to the cancel button */
.form-container .cancel {
  background-color: #4AB0F8;
  font-size: 15px;
}

/* Add some hover effects to buttons */
.form-container .btn:hover, .open-button:hover {
  opacity: 1;
  z-index: 1;
}
div.Bodycontainer2 {
  padding-left: 5%;
  padding-right: 5%;
  padding-bottom: 1%;
  padding-top: 1%;
  text-align: left;

}

div.overflow {
overflow: hidden;
    white-space: nowrap;
	}

code { background-color: #eee; 
width: 100%;}

pre code {
  background-color: #eee;
  border: 1px solid #999;
  display: block;
  padding: 20px;
  width: 70%;

}

</style>
</head>
<body><html>
<div class="topnav">
  <a class="active" href="index">Home</a>
 
<button class="open-button" onclick="openForm()">Contact Me</button>

<div class="form-popup" id="myForm">
  <form action="" class="form-container">
   <center> <h1>Contact Me</h1><br><br>

    <center><label for="email"><b>Email:</b></label></center>
	<input type="text" value="IsabellaElizabethWatson@gmail.com" id="myInput" style="width:85%">
<button onclick="myFunction()" font= >Copy text</button>

<script>
function myFunction() {
  var copyText = document.getElementById("myInput");
  copyText.select();
  copyText.setSelectionRange(0, 99999)
  document.execCommand("copy");
  alert("Copied the text: " + copyText.value);
}
</script>
    
	<br><br>
    <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
  </form>
</div>
</center>
<script>
function openForm() {
  document.getElementById("myForm").style.display = "block";
}

function closeForm() {
  document.getElementById("myForm").style.display = "none";
}
</script>

  <a href="https://www.linkedin.com/in/isabella-watson-786b8a130/">LinkedIn</a><img src ="linkedin.png" height = "35px" width = "20px">
</div>
<div class="hero-image">
  <div class="hero-text">
  </div>
  </div>
  
  <body>
    <div class="Bodycontainer2"><p>
	
<h2>1.0 Background </h2>
<br>
The <i>Manual System</i> is a commercial product I built for my employer, Cell Microsystems (CMS). The purpose of the <i>Manual System</i> is to extend a linear stepper motor by a distance set by the user. I achieved this by converting an analog input (0-1023) from a 10K potentiometer to mm with an Arduino. I coded the Arduiuno to output a pulse-width-modulated (PWM) signal to turn the motor a certain number of steps which correlate to the distance set by the potentiometer. A motor drive shield was used in conjunctoin with the Arduino Uno. <br><br>
<b>*NOTE: This product's manufacture is confidential and thus I will not provide circuit diagrams or too much detail.</b>

<br><br>
<b><h2>2.0 Final Product</h2></b> 
<br>
</div>
<div class ="overflow">
<div class="container3">
<div class="float-child" style = "width:70%">
  <img src="ManualSystem.png" alt="Manual System" style="width:100%" height = "100%">
  <div class="container">
    <p>CMS Manual System</p>
  </div>
</div>
</div>


<div class="container3">
<div class="float-child" style = "width:70%">
  <img src="CMSManual.jpg" alt="Manual System" style="width:100%" height = "100%">
  <div class="container">
    <p>CMS Manual System in Case</p>
  </div>
</div>
</div>
</div>

<p><p>

<div class ="overflow">
    <div class="Bodycontainer2"><p>
<b><h2>3.0 Videos</h2></b> 
</div>
</div>
<div class ="overflow">
<div class="container3">
<div class="float-child" style = "width:70%">
  <img src="manualGif.gif" alt="Biological Models" style="width:100%" height = "100%">
  <div class="container">
    <p>System Operation</p>
  </div>
</div>
</div>


<div class="container3">
<div class="float-child" style = "width:70%">
  <img src="VideoTable.png" alt="Biological Models" style="width:100%" height = "100%">
  <div class="container">
    <p>Table Explaining Functionality</p>
  </div>
</div>
</div></div>

</div>




<div class ="overflow">

    <div class="Bodycontainer2"><p>
	<h2>4.0 Code </h2>
<p>
<pre>
  <code>
#include <AFMotor.h> //needed to drive motor
#include <Wire.h> //needed for circuits
#include <LiquidCrystal_I2C.h> //needed w LCD i2C Library 

AF_Stepper motor(20,1);  //20 steps/rev w motor; Motor connected to port 1 (M1/M2)

LiquidCrystal_I2C lcd(0x27, 16, 2);

//LCDvariablename(address [use find_lcd_screen_address program to locate], 16x2 characters)


int sensorPin = A1;         //select the input pin for the potentiometer
int button = A2;            //select the pin for the button
int sensorValue = 0;        //Initialize variable to store the value coming from the sensor
int homePos = 700;          //number of steps down to home position; overshot to ensure fully 0
int state;              //Initialize variable to store value from button
int motorMove = 0; //state of travel mode
int travelSteps = 0; //number of steps set by pot
int travelDist = 0; //number of steps to travel 
int travelPercent = 0; //percent to display on LCD screen (1-100%)
int align = 0;              //Initialize variable to check if in alignment mode
int delta = 0;              //Initialize variable for movement in alignment mode
int welcome = 1;            //Initialize variable for welcome screen state 
int reading;           // the current reading from the input pin
int check = 0;

void welcomeScreen() {
  motor.step(homePos, BACKWARD, SINGLE); //travel motor to 0 position
  while (welcome == 1){ //repeat while welcome = 1 is true
  lcd.setCursor(0,0); //use first row
  lcd.print("       CMS      ");  //welcome screen 
  lcd.setCursor(0,1); //use second row        
  lcd.print("  Manual System  ");  //welcome screen
  reading = digitalRead(button);  //read state of button (high or low)
   if ((reading) == HIGH)  {  //While the button is pressed
       while ((analogRead(sensorPin) < 5) == 1)  {   //loop while the potentiometer is set below 5 (for safety)
        delay(100); //debounce button
        reading = digitalRead(button); //check button state to ensure it has been released. 
		//This allows for the user to press it for any period of time
        if (reading == LOW){ //if the button is not pressed any longer
        welcome = 0; //set welcome screen to 0 so it never shows up again
        align = 1; //allow alignment mode
        delay(100); //debounce the button (ms)
        Alignment(); //enter alignment mode (always entered upon first boot up for safety)
       }
       }
   delay(100);                             //debounce the button
}
  }
}

void CheckHold()  { //check if button has been pressed
  motor.release();                           //release motor when not in alignment or travel
  delay(100); //debounce the button
  reading = digitalRead(button); //check state of button (HIGH or LOW)
   if (reading == HIGH)  {  //if the button is pressed
    check = 1; //if button has been pressed, loop until it is not pressed anymore
    while (check == 1) {
       if ((analogRead(sensorPin) < 5) == 1)  {   //If the potentiometer is set below 5..
        delay(100);
        reading = digitalRead(button); //recheck button
        if (reading == LOW){ //if it has been released
        motorMove = 0; //disable travel mode
        align = 1; //allow alignment mode
        check = 0; //exit check loop
        delay(100); //debounce button
        Alignment(); //enter alignment mode.
       }
       }
      else { //if pot is greater than 5
        delay(100); //debounce
        reading = digitalRead(button); //read button
        if (reading == LOW){ //if button is released
        motorMove = 1; //enable travel mode
        align = 0; //disable alignment mode
        check = 0; //exit check loop
        delay(100); //debounce
        NeedleRelease(); //enter travel mode
       }
     }
   delay(100);                             //debounce the button
}
}
}

void NeedleRelease()  {
    align = 0; //disable alignment mode
    lcd.clear(); //clear screen
    lcd.setCursor(0,0); //use first row
    lcd.print("   Traveling   ");  //centered "traveling" state
    lcd.setCursor(0,1); //use second row
    lcd.print("      ");  //centering text
    lcd.print(travelPercent);  //print travel distance (1-100%)
    lcd.print("%    ");  //print travel distance (1-100%)                                    
    motor.step(travelSteps, FORWARD, SINGLE); //run motor to the number of steps set by pot
    delay(100); //pause 100ms
    motor.step(homePos, BACKWARD, SINGLE); //run motor to home (overshot)
    delay(500) ;                           //Must wait 500 ms before next release
    lcd.clear();        //clear screen
    motor.release();                       //Make the motor "float" so that it does not consume power
    motorMove = 0; //disable release mode
    loop(); //return to home loop
}

void Alignment()  {
  welcome = 0; //disable welcome screen from now on
  delay(100); //delay
  lcd.clear(); //clear LCD screen
  lcd.setCursor(0,0); //use first row
  lcd.print(" Alignment Mode");  //print which mode
  sensorValue = analogRead(sensorPin);                
  //Read the value from the potentiometer - Range can be from 0 - 1023
  MOVE = round(sensorValue*0.5);                     
  //Multiply value by 0.5 to make max number of steps 512 (10.24 mm) 
  motor.step(MOVE, FORWARD, SINGLE);                  
  //Move motor to position set by potentiometer
  delay(100); //delay
  while (align == 1)  {                              
  //While in alignment mode execute the following code:
  sensorValue = analogRead(sensorPin); //0-1023
  travelPercent = round(sensorValue*.098); //convert potentiometer value to percent
  lcd.setCursor(0,1); //use second row
  lcd.print(" Distance: ");  //print travel distance (1-100%)
  lcd.print(travelPercent);  //print travel distance (1-100%)
  lcd.print("%    ");  //print travel distance (1-100%) 
  travelSteps = round(sensorValue*.5); //capping max steps at = 1023/2 = ~512 steps
  travelDist = travelSteps - delta; //num steps to travel (checks for change from prvious pot value)
  if (travelDist > 4) { //if change is positive & > 4
    motor.step(travelDist, FORWARD, SINGLE); //travel difference in steps
    delta = travelSteps;  //keep track of previous value
  }
  else if (travelDist < -4) { //if change is negative & > 4
    motor.step(abs(travelDist), BACKWARD, SINGLE); //travel difference in steps
    delta = travelSteps;  //keep track of previous value
  }
  motor.release();  //Float the motor to save power
  delay(10); //small delay
  reading = digitalRead(button); //check button state
   if (reading == HIGH)  {  //if the button is pressed
    check = 1; //loop until button is low
    while (check == 1) {  //loop until button is low
        delay(100);
        reading = digitalRead(button);
        if (reading == LOW){ //if button is released
          lcd.clear();
          lcd.setCursor(0,0); //use second row
          lcd.print("    Exiting     ");  //print mode
           lcd.setCursor(0,1); //use second row
          lcd.print(" Alignment Mode");  //print mode
          motor.step(travelSteps, BACKWARD, SINGLE);                  //Return the motor to its initial position
          lcd.clear(); //clear screen
          delay(100); //delay for noise reduction
          align = 0; //disable alignment
          check = 0; //disable check loop
          delay(100); //delay
          loop(); //return to home loop
       }
   delay(100);                             //debounce the button
    }
}
}
}

void setup() {
  Serial.begin(9600); //begin serial communication (9600 for LCD)
  lcd.begin();//Initializing display
  lcd.backlight();//To Power ON the back light NOTE: if backlight doesn't turn on, ensure power jumper is attached
  lcd.clear(); //clear screen
  motor.setSpeed(1500);               //Sets speed in steps per second     
  pinMode(button, INPUT);             //Set the button pin to be an digial input
  delay(100); //delay
  welcomeScreen(); //upon start up, open welcome screen
}

//The following loop runs forever
void loop() {
  welcome = 0; //disable welcome screen
  lcd.setCursor(0,0); //use first row
  lcd.print("Press button to");  //print travel distance (1-100%)
  lcd.setCursor(0,1); //use second row
  lcd.print("Align or Release");  //print travel distance (1-100%)    
  reading = digitalRead(button);      //Check the state of the button
  if (reading == HIGH){ //if the button is pressed..
     CheckHold();                    //Run CheckHold() function
  }
}


 
 
  </code>
</pre>
</div>

</span>
</center>
</div>
</p>
</html>
</body>
